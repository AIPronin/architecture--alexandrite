# Планирование: анализ, идентификация проблем и поиск решений

В ходе анализа были выявлены следующие проблемы в архитектуре приложения

## Проблемные места

1. Отсутствуют инструменты для наблюдения за системой. Без реализации наблюдаемости достаточно сложно обнаружить проблемные места.
2. Долгая обработка заказов. Либо из-за большой нагрузки, либо из-за потери данных при информационном обмене.
3. Инфраструктура проекта не рассчитана на автоматическое и быстрое масштабирование. Инстансы приложений представлены в единственном экземпляре. 
4. Проблемы со списком заказов в MES.
5. Проблемы с процессами связанными с разработкой и тестированием.

## Инициативы

1. Наблюдаемость
   1. Добавить инструменты для обеспечения наблюдаемости приложения. Мониторинг, логирование, трассировка.
   2. Провести анализ движения заказов в системе. Выявить проблемные места при движении заказов, понять какие шаги позволят ускорить время обработки. Выработать подход по контролю времени выполнения заказа и реагированию на инциденты.
2. Производительность 
   1. Добавление кэширования для получения списка заказов в MES и оптимизация запросов к БД на получение списка заказов.
   2. Оптимизация API. Добавление инструментов для работы с обратным давлением при поступлении большого кол-ва заказов от внешних систем.
3. Отказоустойчивость
   1. Произвести изменение архитектуры приложения, с учетом добавления возможности горизонтального масштабирования к компонентам системы.
   2. Переход на архитектуру кластерную архитектуру с возможностью автомасштабирования. 
4. Оптимизация процессов связанных с выпуском релиза, для ускорения доставки изменений в прод.
   1. Добавление различных тестов для повышения надежности системы
   2. Применение инструментов для оптимизации CI/CD процессов

## Ответы на вопросы

1. Какой вы видите целевую архитектуру через полгода?

В первую очередь необходимо внедрить инструменты для обеспечения наблюдаемости системы. 
Следует настроить основные метрики для выявления критических мест в работе системы, сбор и анализ ошибок и настроить оповещения на определенные сценарии (например долгую обработку заказа).

Далее на основании выявленных критических мест, следует запланировать изменение инфраструктуры системы.
К таким изменениям могут относиться:
- Горизонтальное масштабирование магазина, CRM и MES с возможностью автомасштабирования компонентов
- Репликация и шардирование БД
- Кластеризация северов очереди сообщений

Следующим этапом необходимо начать оптимизацию критических мест в работе API:

- Добавление кэширования для наиболее критичных участков 
- Перенос части выполняемых операций в асинхронные команды
- Добавление механизмов обратного давления
- Повышение надежности API (добавление retry операций, работа с исключениями, circuit breaker)

Параллельно с этим следует итеративно оптимизировать процессы выпуска и доставки изменений в прод:
- Git flow
- Оптимизация тестирования
- Повышение надежности релизов
- Оптимизация CI/CD процессов

2. Если бы у вас была возможность выполнить только три пункта из списка инициатив в ближайшие полгода, что бы вы выбрали и почему? Не обязательно добавлять в список только эпики. Вы можете включить в план как крупные изменения, так и локальные задачи.

- Наблюдаемость. Мониторинг и алертинг. Позволит выявить критические места в инфраструктуре и оперативно реагировать на проблемы в системе, например долгую обработку заказов. Позволит понимать состояние системы в текущий момент и планировать улучшения. Позволит закрыть негативные сценарии связанные с потерей заказов.
- Оптимизация инфраструктуры. Добавление горизонтального масштабирования. Позволит решить вопрос с отказоустойчивостью компонентов.
- Оптимизация работы API. Добавление кэширования для операций чтения, оптимизация индексов БД. Позволит наладить работу сотрудников, и снизит нагрузку на систему.